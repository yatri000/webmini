<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phone Mask</title>

<style>
body {
  background:#0a0f17;
  color:#fff;
  font-family:system-ui;
  padding:40px;
}

input {
  width:100%;
  padding:18px;
  font-size:20px;
  border-radius:14px;
  border:none;
  background:rgba(255,255,255,.08);
  color:#fff;
}

button {
  margin-top:20px;
  padding:14px;
  width:100%;
  border-radius:14px;
  border:none;
  background:#4fc3ff;
  font-size:16px;
  font-weight:600;
}
button:disabled {opacity:.4}
</style>
</head>

<body>

<input id="phone" type="tel" placeholder="+7 ___ _______">
<button id="send" disabled>Отправить</button>

<script>
const phone = document.getElementById("phone");
const send  = document.getElementById("send");

let digits = ""; // ХРАНИМ ТОЛЬКО ЦИФРЫ (без +7)

phone.addEventListener("focus", () => {
  if (!phone.value) {
    phone.value = "+7 ";
  }
});

phone.addEventListener("input", () => {
  // берём только цифры, кроме первой 7
  let raw = phone.value.replace(/\D/g, "");

  // убираем ведущую 7 (она всегда есть)
  if (raw.startsWith("7")) raw = raw.slice(1);

  // максимум 10 цифр
  raw = raw.slice(0, 10);
  digits = raw;

  // собираем формат
  let result = "+7 ";

  if (digits.length <= 3) {
    result += digits;
  } else {
    result += digits.slice(0,3) + " " + digits.slice(3);
  }

  phone.value = result;

  // если всё введено — блокируем ввод
  if (digits.length === 10) {
    phone.blur(); // закрывает клавиатуру
  }

  send.disabled = digits.length !== 10;
});

// защита от удаления +7
phone.addEventListener("keydown", (e) => {
  if (phone.selectionStart <= 3 && (e.key === "Backspace" || e.key === "Delete")) {
    e.preventDefault();
  }
});
</script>

</body>
</html>
