<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmartHouse Pro</title>

<style>
:root {
  --bg: #0a0f17;
  --cold: #4fc3ff;
  --card: rgba(255,255,255,0.05);
  --text: #ffffff;
  --muted: #b8c1d1;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: "Segoe UI", system-ui, sans-serif;
  background:
    radial-gradient(circle at left, rgba(79,195,255,0.12), transparent 40%),
    var(--bg);
  color: var(--text);
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 24px;
}

h1 {
  font-size: 22px;
  margin-bottom: 16px;
}

.step { display: none; }
.step.active { display: block; }

.card {
  background: var(--card);
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 12px;
  border: 1px solid rgba(255,255,255,0.08);
}

.option {
  cursor: pointer;
  user-select: none;
  touch-action: manipulation;
}

.option.active {
  border-color: var(--cold);
  box-shadow: 0 0 12px rgba(79,195,255,0.4);
}

textarea, input {
  width: 100%;
  padding: 16px;
  border-radius: 16px;
  border: none;
  background: rgba(255,255,255,0.08);
  color: #fff;
}

textarea.big {
  height: calc(3 * 56px + 24px);
  resize: none;
}

input.big {
  height: 56px;
}

.btn {
  width: 100%;
  padding: 14px;
  margin-top: 12px;
  border-radius: 14px;
  border: none;
  font-size: 16px;
  font-weight: 600;
}

.btn.primary {
  background: linear-gradient(135deg, var(--cold), #3b82f6);
  color: #fff;
}

.btn.secondary {
  background: transparent;
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.15);
}

.btn:disabled {
  opacity: 0.4;
}
</style>
</head>

<body>
<div class="container">

<!-- STEP 1 -->
<div class="step active" id="step1">
  <h1>–ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å?</h1>

  <div class="card option" data-value="–û—Å–≤–µ—â–µ–Ω–∏–µ">üí° –û—Å–≤–µ—â–µ–Ω–∏–µ</div>
  <div class="card option" data-value="–ö–ª–∏–º–∞—Ç">üå° –ö–ª–∏–º–∞—Ç</div>
  <div class="card option" data-value="–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å">üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>

  <textarea id="comment1" class="big" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–∏–ª–∏ –æ–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É)"></textarea>

  <button id="next1" class="btn primary" disabled onclick="nextStep()">–î–∞–ª–µ–µ</button>
</div>

<!-- STEP 2 -->
<div class="step" id="step2">
  <h1>–ì–¥–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞?</h1>

  <div class="card option single" data-value="–ö–≤–∞—Ä—Ç–∏—Ä–∞">üè† –ö–≤–∞—Ä—Ç–∏—Ä–∞</div>
  <div class="card option single" data-value="–î–æ–º">üè° –ß–∞—Å—Ç–Ω—ã–π –¥–æ–º</div>
  <div class="card option single" data-value="–û—Ñ–∏—Å">üè¢ –û—Ñ–∏—Å</div>

  <textarea id="comment2" class="big" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—ç—Ç–∞–∂, —Å—Ç–∞–¥–∏—è —Ä–µ–º–æ–Ω—Ç–∞ –∏ —Ç.–ø.)"></textarea>

  <button class="btn secondary" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
  <button id="next2" class="btn primary" disabled onclick="nextStep()">–î–∞–ª–µ–µ</button>
</div>

<!-- STEP 3 -->
<div class="step" id="step3">
  <h1>–ö–∞–∫ —Å –≤–∞–º–∏ —Å–≤—è–∑–∞—Ç—å—Å—è?</h1>

  <input id="name" class="big" placeholder="–ò–º—è">
  <input id="phone" class="big" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">

  <div class="card option multi" data-value="–¢–µ–ª–µ—Ñ–æ–Ω">üìû –ó–≤–æ–Ω–æ–∫</div>
  <div class="card option multi" data-value="WhatsApp">üí¨ WhatsApp</div>
  <div class="card option multi" data-value="Telegram">ü§ñ Telegram</div>

  <button class="btn secondary" onclick="prevStep()">–ù–∞–∑–∞–¥</button>
  <button id="send" class="btn primary" disabled onclick="submitForm()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>

<!-- STEP 4 -->
<div class="step" id="step4">
  <h1>‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞</h1>
  <button class="btn primary" onclick="closeApp()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ Telegram</button>
</div>

</div>

<script>
const tg = window.Telegram?.WebApp || {
  ready: () => {},
  sendData: d => console.log("DATA:", d),
  close: () => {}
};
tg.ready();

let step = 1;

// auto name
if (tg.initDataUnsafe?.user) {
  name.value = tg.initDataUnsafe.user.first_name || "";
}

// click options
document.addEventListener("click", e => {
  const opt = e.target.closest(".option");
  if (!opt) return;

  if (opt.classList.contains("single")) {
    opt.parentElement.querySelectorAll(".option.single")
      .forEach(o => o.classList.remove("active"));
    opt.classList.add("active");
  } else {
    opt.classList.toggle("active");
  }

  validate();
});

// validation
["comment1","comment2","phone","name"].forEach(id => {
  document.getElementById(id)?.addEventListener("input", validate);
});

function validate() {
  next1.disabled = !(
    document.querySelector("#step1 .option.active") ||
    comment1.value.trim()
  );

  next2.disabled = !(
    document.querySelector("#step2 .option.active") ||
    comment2.value.trim()
  );

  send.disabled = !(
    phone.value.trim() &&
    document.querySelectorAll("#step3 .option.active").length
  );
}

// navigation
function nextStep() {
  document.getElementById(`step${step}`).classList.remove("active");
  step++;
  document.getElementById(`step${step}`).classList.add("active");
}

function prevStep() {
  document.getElementById(`step${step}`).classList.remove("active");
  step--;
  document.getElementById(`step${step}`).classList.add("active");
}

// submit
function submitForm() {
  const data = {
    interests: [...document.querySelectorAll("#step1 .option.active")].map(e=>e.dataset.value),
    object: document.querySelector("#step2 .option.active")?.dataset.value,
    comments: [comment1.value, comment2.value].filter(Boolean),
    name: name.value,
    phone: phone.value,
    contacts: [...document.querySelectorAll("#step3 .option.active")].map(e=>e.dataset.value)
  };

  tg.sendData(JSON.stringify(data));
  nextStep();
}

function closeApp() { tg.close(); }
</script>

</body>
</html>
