<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmartHouse Pro</title>

<style>
:root {
  --bg: #0a0f17;
  --cold: #4fc3ff;
  --warm: #ffb86b;
  --card: rgba(255,255,255,0.05);
  --text: #ffffff;
  --muted: #b8c1d1;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Segoe UI", system-ui, sans-serif;
  background:
    radial-gradient(circle at left, rgba(79,195,255,0.12), transparent 40%),
    radial-gradient(circle at right, rgba(255,184,107,0.15), transparent 40%),
    var(--bg);
  color: var(--text);
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 24px;
}

h1 {
  font-size: 22px;
  margin-bottom: 16px;
}

.step {
  display: none;
}

.step.active {
  display: block;
}

.card {
  background: var(--card);
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 12px;
  border: 1px solid rgba(255,255,255,0.08);
}

.option {
  cursor: pointer;
  transition: 0.2s;
  touch-action: manipulation;
  user-select: none;
}

.option.active {
  border-color: var(--cold);
  box-shadow: 0 0 12px rgba(79,195,255,0.4);
}

.btn {
  width: 100%;
  margin-top: 20px;
  padding: 14px;
  border-radius: 14px;
  border: none;
  background: linear-gradient(135deg, var(--cold), #3b82f6);
  color: #fff;
  font-size: 16px;
  font-weight: 600;
}

input, textarea {
  width: 100%;
  padding: 12px;
  border-radius: 12px;
  border: none;
  margin-bottom: 12px;
  background: rgba(255,255,255,0.08);
  color: #fff;
}

textarea {
  resize: none;
}
</style>
</head>

<body>
<div class="container">

<!-- STEP 1 -->
<div class="step active" id="step1">
  <h1>–ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å?</h1>

  <div class="card option" data-value="–û—Å–≤–µ—â–µ–Ω–∏–µ">üí° –û—Å–≤–µ—â–µ–Ω–∏–µ</div>
  <div class="card option" data-value="–ö–ª–∏–º–∞—Ç">üå° –ö–ª–∏–º–∞—Ç</div>
  <div class="card option" data-value="–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å">üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>
  <div class="card option" data-value="–°—Ü–µ–Ω–∞—Ä–∏–∏">‚öôÔ∏è –°—Ü–µ–Ω–∞—Ä–∏–∏</div>
  <div class="card option" data-value="–®—Ç–æ—Ä—ã">ü™ü –®—Ç–æ—Ä—ã / –∂–∞–ª—é–∑–∏</div>

  <button class="btn" onclick="nextStep()">–î–∞–ª–µ–µ</button>
</div>

<!-- STEP 2 -->
<div class="step" id="step2">
  <h1>–ì–¥–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞?</h1>

  <div class="card option single" data-value="–ö–≤–∞—Ä—Ç–∏—Ä–∞">üè† –ö–≤–∞—Ä—Ç–∏—Ä–∞</div>
  <div class="card option single" data-value="–î–æ–º">üè° –ß–∞—Å—Ç–Ω—ã–π –¥–æ–º</div>
  <div class="card option single" data-value="–û—Ñ–∏—Å">üè¢ –û—Ñ–∏—Å</div>
  <div class="card option single" data-value="–ï—Å—Ç—å —Å–∏—Å—Ç–µ–º–∞">üõ† –£–∂–µ –µ—Å—Ç—å —É–º–Ω—ã–π –¥–æ–º</div>

  <textarea id="comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>

  <button class="btn" onclick="nextStep()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
</div>

<!-- STEP 3 -->
<div class="step" id="step3">
  <h1>–ö–∞–∫ —Å –≤–∞–º–∏ —Å–≤—è–∑–∞—Ç—å—Å—è?</h1>

  <input id="name" placeholder="–ò–º—è">
  <input id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">

  <div class="card option single" data-value="–¢–µ–ª–µ—Ñ–æ–Ω">üìû –ó–≤–æ–Ω–æ–∫</div>
  <div class="card option single" data-value="WhatsApp">üí¨ WhatsApp</div>
  <div class="card option single" data-value="Telegram">ü§ñ Telegram</div>

  <button class="btn" onclick="submitForm()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
</div>

<!-- STEP 4 -->
<div class="step" id="step4">
  <h1>‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞</h1>
  <p>–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</p>
  <button class="btn" onclick="closeApp()">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ Telegram</button>
</div>

</div>

<script>
/* ---------- SAFE TELEGRAM FALLBACK ---------- */
const tg = window.Telegram?.WebApp || {
  ready: () => {},
  sendData: (d) => {
    console.log("BROWSER MODE DATA:", d);
    alert("–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã (browser mode). –°–º–æ—Ç—Ä–∏ console.");
  },
  close: () => {
    alert("–ó–∞–∫—Ä—ã—Ç–∏–µ WebApp (browser mode)");
  }
};
tg.ready();

/* ---------- STATE ---------- */
let step = 1;

/* ---------- AUTO NAME ---------- */
if (tg.initDataUnsafe?.user) {
  document.getElementById("name").value =
    tg.initDataUnsafe.user.first_name || "";
}

/* ---------- OPTION HANDLER (EVENT DELEGATION) ---------- */
document.addEventListener("click", (e) => {
  const option = e.target.closest(".option");
  if (!option) return;

  if (option.classList.contains("single")) {
    option
      .parentElement
      .querySelectorAll(".option.single")
      .forEach(el => el.classList.remove("active"));
    option.classList.add("active");
  } else {
    option.classList.toggle("active");
  }
});

/* ---------- STEP CONTROL ---------- */
function nextStep() {
  document.getElementById(`step${step}`).classList.remove("active");
  step++;
  document.getElementById(`step${step}`).classList.add("active");
}

/* ---------- SUBMIT ---------- */
function submitForm() {
  const data = {
    interests: [...document.querySelectorAll("#step1 .option.active")]
      .map(e => e.dataset.value),
    object: document.querySelector("#step2 .option.active")?.dataset.value,
    comment: document.getElementById("comment").value,
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    contact: document.querySelector("#step3 .option.active")?.dataset.value
  };

  tg.sendData(JSON.stringify(data));
  nextStep();
}

function closeApp() {
  tg.close();
}
</script>

</body>
</html>
